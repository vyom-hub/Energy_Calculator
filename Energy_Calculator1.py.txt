{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "db8ee21d-0f90-48af-9050-ed36f236318f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: streamlit in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (1.39.0)\n",
      "Requirement already satisfied: pandas in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (2.2.3)\n",
      "Requirement already satisfied: plotly in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (6.2.0)\n",
      "Requirement already satisfied: altair<6,>=4.0 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from streamlit) (5.4.1)\n",
      "Requirement already satisfied: blinker<2,>=1.0.0 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from streamlit) (1.8.2)\n",
      "Requirement already satisfied: cachetools<6,>=4.0 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from streamlit) (5.5.0)\n",
      "Requirement already satisfied: click<9,>=7.0 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from streamlit) (8.1.7)\n",
      "Requirement already satisfied: numpy<3,>=1.20 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from streamlit) (1.26.4)\n",
      "Requirement already satisfied: packaging<25,>=20 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from streamlit) (24.1)\n",
      "Requirement already satisfied: pillow<11,>=7.1.0 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from streamlit) (10.4.0)\n",
      "Requirement already satisfied: protobuf<6,>=3.20 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from streamlit) (4.25.5)\n",
      "Requirement already satisfied: pyarrow>=7.0 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from streamlit) (17.0.0)\n",
      "Requirement already satisfied: requests<3,>=2.27 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from streamlit) (2.32.3)\n",
      "Requirement already satisfied: rich<14,>=10.14.0 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from streamlit) (13.9.1)\n",
      "Requirement already satisfied: tenacity<10,>=8.1.0 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from streamlit) (9.0.0)\n",
      "Requirement already satisfied: toml<2,>=0.10.1 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from streamlit) (0.10.2)\n",
      "Requirement already satisfied: typing-extensions<5,>=4.3.0 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from streamlit) (4.12.2)\n",
      "Requirement already satisfied: gitpython!=3.1.19,<4,>=3.0.7 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from streamlit) (3.1.43)\n",
      "Requirement already satisfied: pydeck<1,>=0.8.0b4 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from streamlit) (0.9.1)\n",
      "Requirement already satisfied: tornado<7,>=6.0.3 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from streamlit) (6.4.1)\n",
      "Requirement already satisfied: watchdog<6,>=2.1.5 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from streamlit) (5.0.3)\n",
      "Requirement already satisfied: python-dateutil>=2.8.2 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from pandas) (2.9.0.post0)\n",
      "Requirement already satisfied: pytz>=2020.1 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from pandas) (2024.2)\n",
      "Requirement already satisfied: tzdata>=2022.7 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from pandas) (2024.2)\n",
      "Requirement already satisfied: narwhals>=1.15.1 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from plotly) (1.46.0)\n",
      "Requirement already satisfied: jinja2 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from altair<6,>=4.0->streamlit) (3.1.4)\n",
      "Requirement already satisfied: jsonschema>=3.0 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from altair<6,>=4.0->streamlit) (4.23.0)\n",
      "Requirement already satisfied: colorama in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from click<9,>=7.0->streamlit) (0.4.6)\n",
      "Requirement already satisfied: gitdb<5,>=4.0.1 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from gitpython!=3.1.19,<4,>=3.0.7->streamlit) (4.0.11)\n",
      "Requirement already satisfied: six>=1.5 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from python-dateutil>=2.8.2->pandas) (1.16.0)\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from requests<3,>=2.27->streamlit) (3.3.2)\n",
      "Requirement already satisfied: idna<4,>=2.5 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from requests<3,>=2.27->streamlit) (3.10)\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from requests<3,>=2.27->streamlit) (2.2.3)\n",
      "Requirement already satisfied: certifi>=2017.4.17 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from requests<3,>=2.27->streamlit) (2024.8.30)\n",
      "Requirement already satisfied: markdown-it-py>=2.2.0 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from rich<14,>=10.14.0->streamlit) (3.0.0)\n",
      "Requirement already satisfied: pygments<3.0.0,>=2.13.0 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from rich<14,>=10.14.0->streamlit) (2.18.0)\n",
      "Requirement already satisfied: smmap<6,>=3.0.1 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from gitdb<5,>=4.0.1->gitpython!=3.1.19,<4,>=3.0.7->streamlit) (5.0.1)\n",
      "Requirement already satisfied: MarkupSafe>=2.0 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from jinja2->altair<6,>=4.0->streamlit) (2.1.5)\n",
      "Requirement already satisfied: attrs>=22.2.0 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from jsonschema>=3.0->altair<6,>=4.0->streamlit) (24.2.0)\n",
      "Requirement already satisfied: jsonschema-specifications>=2023.03.6 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from jsonschema>=3.0->altair<6,>=4.0->streamlit) (2023.12.1)\n",
      "Requirement already satisfied: referencing>=0.28.4 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from jsonschema>=3.0->altair<6,>=4.0->streamlit) (0.35.1)\n",
      "Requirement already satisfied: rpds-py>=0.7.1 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from jsonschema>=3.0->altair<6,>=4.0->streamlit) (0.20.0)\n",
      "Requirement already satisfied: mdurl~=0.1 in c:\\users\\parth\\miniconda3\\envs\\gymai\\lib\\site-packages (from markdown-it-py>=2.2.0->rich<14,>=10.14.0->streamlit) (0.1.2)\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    }
   ],
   "source": [
    "pip install streamlit pandas plotly\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "a654ded9-a50d-4974-a808-080383d91e99",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2025-07-08 09:32:20.751 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:20.755 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.086 \n",
      "  \u001b[33m\u001b[1mWarning:\u001b[0m to view this Streamlit app on a browser, run it with the following\n",
      "  command:\n",
      "\n",
      "    streamlit run C:\\Users\\PARTH\\miniconda3\\envs\\gymai\\Lib\\site-packages\\ipykernel_launcher.py [ARGUMENTS]\n",
      "2025-07-08 09:32:22.089 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.092 No runtime found, using MemoryCacheStorageManager\n",
      "2025-07-08 09:32:22.098 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.099 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.100 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.102 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.105 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.106 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.107 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.108 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.110 Session state does not function when running a script without `streamlit run`\n",
      "2025-07-08 09:32:22.112 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.113 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.114 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.115 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.116 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.117 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.119 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.120 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.122 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.126 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.128 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.130 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.131 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.132 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.134 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.136 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.137 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.138 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.138 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.140 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.141 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.145 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.146 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.148 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.149 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.151 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.152 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.154 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.156 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.158 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.159 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.161 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.162 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.164 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.165 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.166 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.167 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.168 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.169 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.171 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.172 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.173 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.174 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.176 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.177 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.179 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.182 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.183 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.185 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.187 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n",
      "2025-07-08 09:32:22.189 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.\n"
     ]
    }
   ],
   "source": [
    "import streamlit as st\n",
    "import pandas as pd\n",
    "import plotly.express as px\n",
    "import plotly.graph_objects as go\n",
    "from datetime import datetime, timedelta\n",
    "import json\n",
    "import os\n",
    "\n",
    "# Page configuration\n",
    "st.set_page_config(\n",
    "    page_title=\"Energy Consumption Tracker\",\n",
    "    page_icon=\"‚ö°\",\n",
    "    layout=\"wide\",\n",
    "    initial_sidebar_state=\"expanded\"\n",
    ")\n",
    "\n",
    "# Custom CSS for better styling\n",
    "st.markdown(\"\"\"\n",
    "<style>\n",
    "    .main-header {\n",
    "        background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);\n",
    "        padding: 2rem;\n",
    "        border-radius: 10px;\n",
    "        margin-bottom: 2rem;\n",
    "        color: white;\n",
    "        text-align: center;\n",
    "    }\n",
    "    \n",
    "    .metric-card {\n",
    "        background: white;\n",
    "        padding: 1.5rem;\n",
    "        border-radius: 10px;\n",
    "        box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n",
    "        border-left: 4px solid #667eea;\n",
    "    }\n",
    "    \n",
    "    .energy-tip {\n",
    "        background: #f0f8ff;\n",
    "        padding: 1rem;\n",
    "        border-radius: 8px;\n",
    "        border-left: 4px solid #4CAF50;\n",
    "        margin: 1rem 0;\n",
    "    }\n",
    "    \n",
    "    .stButton > button {\n",
    "        background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);\n",
    "        color: white;\n",
    "        border: none;\n",
    "        border-radius: 8px;\n",
    "        padding: 0.5rem 1rem;\n",
    "        font-weight: bold;\n",
    "    }\n",
    "    \n",
    "    .sidebar .sidebar-content {\n",
    "        background: #f8f9fa;\n",
    "    }\n",
    "</style>\n",
    "\"\"\", unsafe_allow_html=True)\n",
    "\n",
    "# Data file path\n",
    "DATA_FILE = \"energy_consumption_data.json\"\n",
    "\n",
    "# Load existing data\n",
    "@st.cache_data\n",
    "def load_data():\n",
    "    if os.path.exists(DATA_FILE):\n",
    "        try:\n",
    "            with open(DATA_FILE, 'r') as f:\n",
    "                return json.load(f)\n",
    "        except:\n",
    "            return {}\n",
    "    return {}\n",
    "\n",
    "# Save data\n",
    "def save_data(data):\n",
    "    with open(DATA_FILE, 'w') as f:\n",
    "        json.dump(data, f, indent=2)\n",
    "\n",
    "# Calculate energy consumption\n",
    "def calculate_energy_consumption(facility, has_ac, has_fridge, has_washing_machine, usage_hours):\n",
    "    base_consumption = 0\n",
    "    \n",
    "    # Base consumption based on facility type (kWh per day)\n",
    "    facility_consumption = {\n",
    "        \"1bhk\": 2 * 0.4 + 2 * 0.8,  # 2.4 kWh\n",
    "        \"2bhk\": 3 * 0.4 + 3 * 0.8,  # 3.6 kWh\n",
    "        \"3bhk\": 4 * 0.4 + 4 * 0.8   # 4.8 kWh\n",
    "    }\n",
    "    \n",
    "    base_consumption = facility_consumption.get(facility.lower(), 0)\n",
    "    \n",
    "    # Additional appliances consumption (kWh per day)\n",
    "    appliance_consumption = 0\n",
    "    if has_ac:\n",
    "        appliance_consumption += 3 * (usage_hours.get('ac', 8) / 24)\n",
    "    if has_fridge:\n",
    "        appliance_consumption += 3 * (usage_hours.get('fridge', 24) / 24)\n",
    "    if has_washing_machine:\n",
    "        appliance_consumption += 2 * (usage_hours.get('washing_machine', 2) / 24)\n",
    "    \n",
    "    return base_consumption + appliance_consumption\n",
    "\n",
    "# Main app\n",
    "def main():\n",
    "    # Header\n",
    "    st.markdown(\"\"\"\n",
    "    <div class=\"main-header\">\n",
    "        <h1>‚ö° Energy Consumption Tracker</h1>\n",
    "        <p>Monitor and optimize your daily energy usage</p>\n",
    "    </div>\n",
    "    \"\"\", unsafe_allow_html=True)\n",
    "    \n",
    "    # Sidebar for user input\n",
    "    st.sidebar.header(\"üìù User Information\")\n",
    "    \n",
    "    # Personal Information\n",
    "    name = st.sidebar.text_input(\"üë§ Enter your name:\", placeholder=\"John Doe\")\n",
    "    age = st.sidebar.number_input(\"üéÇ Enter your age:\", min_value=1, max_value=120, value=25)\n",
    "    city = st.sidebar.text_input(\"üèôÔ∏è Enter your city:\", placeholder=\"Mumbai\")\n",
    "    area = st.sidebar.text_input(\"üìç Enter your area:\", placeholder=\"Andheri\")\n",
    "    \n",
    "    # Housing Information\n",
    "    st.sidebar.header(\"üè† Housing Details\")\n",
    "    \n",
    "    flat_tenement = st.sidebar.selectbox(\n",
    "        \"üèòÔ∏è Type of residence:\",\n",
    "        [\"Flat\", \"Tenement\", \"Independent House\"]\n",
    "    )\n",
    "    \n",
    "    facility = st.sidebar.selectbox(\n",
    "        \"üè† House configuration:\",\n",
    "        [\"1BHK\", \"2BHK\", \"3BHK\", \"4BHK+\"]\n",
    "    )\n",
    "    \n",
    "    # Appliances\n",
    "    st.sidebar.header(\"üîå Appliances\")\n",
    "    \n",
    "    has_ac = st.sidebar.checkbox(\"‚ùÑÔ∏è Air Conditioner\")\n",
    "    has_fridge = st.sidebar.checkbox(\"üßä Refrigerator\")\n",
    "    has_washing_machine = st.sidebar.checkbox(\"üëï Washing Machine\")\n",
    "    \n",
    "    # Usage hours\n",
    "    usage_hours = {}\n",
    "    if has_ac:\n",
    "        usage_hours['ac'] = st.sidebar.slider(\"AC usage hours per day:\", 1, 24, 8)\n",
    "    if has_fridge:\n",
    "        usage_hours['fridge'] = 24  # Fridge runs 24/7\n",
    "    if has_washing_machine:\n",
    "        usage_hours['washing_machine'] = st.sidebar.slider(\"Washing Machine usage hours per day:\", 1, 8, 2)\n",
    "    \n",
    "    # Calculate consumption\n",
    "    if name and city:\n",
    "        daily_consumption = calculate_energy_consumption(\n",
    "            facility, has_ac, has_fridge, has_washing_machine, usage_hours\n",
    "        )\n",
    "        \n",
    "        # Display current consumption\n",
    "        col1, col2, col3, col4 = st.columns(4)\n",
    "        \n",
    "        with col1:\n",
    "            st.metric(\n",
    "                \"‚ö° Daily Consumption\",\n",
    "                f\"{daily_consumption:.2f} kWh\",\n",
    "                delta=f\"‚Çπ{daily_consumption * 6:.2f}/day\"\n",
    "            )\n",
    "        \n",
    "        with col2:\n",
    "            st.metric(\n",
    "                \"üìÖ Monthly Estimate\",\n",
    "                f\"{daily_consumption * 30:.2f} kWh\",\n",
    "                delta=f\"‚Çπ{daily_consumption * 30 * 6:.2f}/month\"\n",
    "            )\n",
    "        \n",
    "        with col3:\n",
    "            st.metric(\n",
    "                \"üìä Annual Estimate\",\n",
    "                f\"{daily_consumption * 365:.2f} kWh\",\n",
    "                delta=f\"‚Çπ{daily_consumption * 365 * 6:.2f}/year\"\n",
    "            )\n",
    "        \n",
    "        with col4:\n",
    "            co2_emission = daily_consumption * 0.82  # kg CO2 per kWh\n",
    "            st.metric(\n",
    "                \"üå± Daily CO‚ÇÇ Emission\",\n",
    "                f\"{co2_emission:.2f} kg\",\n",
    "                delta=f\"{co2_emission * 365:.0f} kg/year\"\n",
    "            )\n",
    "        \n",
    "        # Save data button\n",
    "        if st.button(\"üíæ Save Today's Data\"):\n",
    "            data = load_data()\n",
    "            today = datetime.now().strftime(\"%Y-%m-%d\")\n",
    "            \n",
    "            if name not in data:\n",
    "                data[name] = {}\n",
    "            \n",
    "            data[name][today] = {\n",
    "                \"age\": age,\n",
    "                \"city\": city,\n",
    "                \"area\": area,\n",
    "                \"flat_tenement\": flat_tenement,\n",
    "                \"facility\": facility,\n",
    "                \"has_ac\": has_ac,\n",
    "                \"has_fridge\": has_fridge,\n",
    "                \"has_washing_machine\": has_washing_machine,\n",
    "                \"usage_hours\": usage_hours,\n",
    "                \"daily_consumption\": daily_consumption,\n",
    "                \"cost\": daily_consumption * 6,\n",
    "                \"co2_emission\": co2_emission\n",
    "            }\n",
    "            \n",
    "            save_data(data)\n",
    "            st.success(f\"‚úÖ Data saved for {name} on {today}\")\n",
    "        \n",
    "        # Historical data visualization\n",
    "        st.header(\"üìà Historical Data\")\n",
    "        \n",
    "        data = load_data()\n",
    "        if name in data and data[name]:\n",
    "            # Create DataFrame for visualization\n",
    "            user_data = data[name]\n",
    "            df_data = []\n",
    "            \n",
    "            for date, record in user_data.items():\n",
    "                df_data.append({\n",
    "                    'Date': pd.to_datetime(date),\n",
    "                    'Consumption (kWh)': record['daily_consumption'],\n",
    "                    'Cost (‚Çπ)': record['cost'],\n",
    "                    'CO‚ÇÇ Emission (kg)': record['co2_emission']\n",
    "                })\n",
    "            \n",
    "            if df_data:\n",
    "                df = pd.DataFrame(df_data)\n",
    "                df = df.sort_values('Date')\n",
    "                \n",
    "                # Charts\n",
    "                col1, col2 = st.columns(2)\n",
    "                \n",
    "                with col1:\n",
    "                    fig1 = px.line(\n",
    "                        df, x='Date', y='Consumption (kWh)',\n",
    "                        title='Daily Energy Consumption Trend',\n",
    "                        line_shape='spline'\n",
    "                    )\n",
    "                    fig1.update_layout(\n",
    "                        plot_bgcolor='rgba(0,0,0,0)',\n",
    "                        paper_bgcolor='rgba(0,0,0,0)',\n",
    "                    )\n",
    "                    st.plotly_chart(fig1, use_container_width=True)\n",
    "                \n",
    "                with col2:\n",
    "                    fig2 = px.bar(\n",
    "                        df, x='Date', y='Cost (‚Çπ)',\n",
    "                        title='Daily Energy Cost',\n",
    "                        color='Cost (‚Çπ)',\n",
    "                        color_continuous_scale='Viridis'\n",
    "                    )\n",
    "                    fig2.update_layout(\n",
    "                        plot_bgcolor='rgba(0,0,0,0)',\n",
    "                        paper_bgcolor='rgba(0,0,0,0)',\n",
    "                    )\n",
    "                    st.plotly_chart(fig2, use_container_width=True)\n",
    "                \n",
    "                # Summary statistics\n",
    "                st.subheader(\"üìä Summary Statistics\")\n",
    "                col1, col2, col3 = st.columns(3)\n",
    "                \n",
    "                with col1:\n",
    "                    avg_consumption = df['Consumption (kWh)'].mean()\n",
    "                    st.metric(\"Average Daily Consumption\", f\"{avg_consumption:.2f} kWh\")\n",
    "                \n",
    "                with col2:\n",
    "                    total_cost = df['Cost (‚Çπ)'].sum()\n",
    "                    st.metric(\"Total Cost (Period)\", f\"‚Çπ{total_cost:.2f}\")\n",
    "                \n",
    "                with col3:\n",
    "                    total_emission = df['CO‚ÇÇ Emission (kg)'].sum()\n",
    "                    st.metric(\"Total CO‚ÇÇ Emission\", f\"{total_emission:.2f} kg\")\n",
    "                \n",
    "                # Data table\n",
    "                st.subheader(\"üìã Detailed Records\")\n",
    "                st.dataframe(df.style.format({\n",
    "                    'Consumption (kWh)': '{:.2f}',\n",
    "                    'Cost (‚Çπ)': '‚Çπ{:.2f}',\n",
    "                    'CO‚ÇÇ Emission (kg)': '{:.2f}'\n",
    "                }), use_container_width=True)\n",
    "        \n",
    "        else:\n",
    "            st.info(\"No historical data found. Start tracking by saving today's data!\")\n",
    "        \n",
    "        # Energy saving tips\n",
    "        st.header(\"üí° Energy Saving Tips\")\n",
    "        \n",
    "        tips = [\n",
    "            \"üåü Use LED bulbs instead of incandescent ones to save up to 80% energy\",\n",
    "            \"‚ùÑÔ∏è Set your AC temperature to 24¬∞C for optimal comfort and efficiency\",\n",
    "            \"üîå Unplug electronics when not in use to avoid phantom power consumption\",\n",
    "            \"üåû Use natural light during the day and switch off unnecessary lights\",\n",
    "            \"üßä Keep your refrigerator between 3-4¬∞C and freezer at -18¬∞C\",\n",
    "            \"üëï Wash clothes in cold water when possible to save energy\",\n",
    "            \"ü™ü Use curtains or blinds to keep your home cool and reduce AC usage\"\n",
    "        ]\n",
    "        \n",
    "        for tip in tips:\n",
    "            st.markdown(f\"\"\"\n",
    "            <div class=\"energy-tip\">\n",
    "                {tip}\n",
    "            </div>\n",
    "            \"\"\", unsafe_allow_html=True)\n",
    "\n",
    "if __name__ == \"__main__\":\n",
    "    main()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "049780e1-d679-4d66-859d-6157ae8c31c8",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
